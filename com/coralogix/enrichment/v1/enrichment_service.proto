syntax = "proto3";

import "google/protobuf/wrappers.proto";
import "com/coralogix/enrichment/v1/enrichment_type.proto";
import "com/coralogix/enrichment/v1/enrichment.proto";

package com.coralogix.global_mapping.v1;

message EnrichmentRequestModel {
  google.protobuf.StringValue field_name = 1;
  oneof type_id {
    google.protobuf.UInt32Value built_in = 2;
    google.protobuf.UInt32Value custom = 3;
  }
}

message GetEnrichmentsRequest {

}

message GetEnrichmentsResponse {
  repeated Enrichment enrichments = 1;
  uint32 limit = 2;
}

message AddEnrichmentsRequest {
  repeated EnrichmentRequestModel request_enrichments = 1;
}

message AddEnrichmentsResponse {
  repeated Enrichment created_enrichments = 1;
}

message RemoveEnrichmentsResponse {
  repeated google.protobuf.UInt32Value enrichment_ids = 1;
}

message RemoveEnrichmentsRequest {
  repeated Enrichment deleted_enrichments = 1;
}

service EnrichmentService {
  rpc GetEnrichments(GetEnrichmentsRequest) returns (GetEnrichmentsResponse);
  rpc AddEnrichments(AddEnrichmentsRequest) returns (AddEnrichmentsResponse);
  rpc RemoveEnrichments(RemoveEnrichmentsRequest) returns (RemoveEnrichmentsResponse);
}